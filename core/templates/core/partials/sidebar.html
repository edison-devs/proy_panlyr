{% load groups %}

<nav class="col-md-2 bg-dark text-white min-vh-100 overflow-auto">
    <h5 class="text-center py-3">Pablito 14</h5>
    <ul class="nav flex-column">
        
        <!-- PRODUCTS -->
        {% if user|has_any_group:"admin,employed,viewer" %}
        <li class="nav-item">
            <a class="nav-link text-white d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#menuProducts" role="button" aria-expanded="false" aria-controls="menuProducts">
                PRODUCTS <span class="badge bg-secondary">▸</span>
            </a>
            <div class="collapse" id="menuProducts">
                <ul class="nav flex-column ms-3">
                    <li class="nav-item">
                        <a  href="{% url 'product-index' %}" class="nav-link text-white">Ver</a>
                    </li>
                    
                    {% if user|has_any_group:"admin,employed" %}
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'product-create' %}?action=new">Nuevo</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </li>
        {% endif %}

        <!-- OUTPUTS -->
        {% if user|has_any_group:"admin,employed,viewer" %}
        <li class="nav-item">
            <a class="nav-link text-white d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#menuOutputs" role="button" aria-expanded="false" aria-controls="menuOutputs">
                OUTPUTS <span class="badge bg-secondary">▸</span>
            </a>
            <div class="collapse" id="menuOutputs">
                {% comment %} <ul class="nav flex-column ms-3">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'outputs' %}">Ver</a>
                    </li>
                    {% if user|has_any_group:"admin,employed" %}
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'outputs' %}?action=new">Nuevo</a>
                    </li>
                    {% endif %}
                </ul> {% endcomment %}
            </div>
        </li>
        {% endif %}

        <!-- INPUTS -->
        {% if user|has_any_group:"admin,employed,viewer" %}
        <li class="nav-item">
            <a class="nav-link text-white d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#menuInputs" role="button" aria-expanded="false" aria-controls="menuInputs">
                INPUTS <span class="badge bg-secondary">▸</span>
            </a>
            <div class="collapse" id="menuInputs">
                {% comment %} <ul class="nav flex-column ms-3">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'inputs' %}">Ver</a>
                    </li>
                    {% if user|has_any_group:"admin,employed" %}
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'inputs' %}?action=new">Nuevo</a>
                    </li>
                    {% endif %}
                </ul> {% endcomment %}
            </div>
        </li>
        {% endif %}

        <!-- INVOICES -->
        {% if user|has_any_group:"admin,employed,viewer" %}
        <li class="nav-item">
            <a class="nav-link text-white d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#menuInvoices" role="button" aria-expanded="false" aria-controls="menuInvoices">
                INVOICES <span class="badge bg-secondary">▸</span>
            </a>
            <div class="collapse" id="menuInvoices">
                {% comment %} <ul class="nav flex-column ms-3">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'invoices' %}">Ver</a>
                    </li>
                    {% if user|has_any_group:"admin,employed" %}
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'invoices' %}?action=new">Nuevo</a>
                    </li>
                    {% endif %}
                </ul> {% endcomment %}
            </div>
        </li>
        {% endif %}

        <!-- CATEGORIES -->
        {% if user|has_any_group:"admin,employed,viewer" %}
        <li class="nav-item">
            <a class="nav-link text-white d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#menuCategories" role="button" aria-expanded="false" aria-controls="menuCategories">
                CATEGORIES <span class="badge bg-secondary">▸</span>
            </a>
            <div class="collapse" id="menuCategories">
                {% comment %} <ul class="nav flex-column ms-3">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'category_products-index' %}">Listar</a>
                    </li>
                    {% if user|has_any_group:"admin,employed" %}
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'category_products-create' %}?action=new">Nuevo</a>
                    </li>
                    {% endif %}
                </ul> {% endcomment %}
            </div>
        </li>
        {% endif %}

        <!-- USERS - Solo para admin -->
        {% if user|has_group:"admin" %}
        <li class="nav-item">
            <a class="nav-link text-white d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#menuUsers" role="button" aria-expanded="false" aria-controls="menuUsers">
                USERS <span class="badge bg-secondary">▸</span>
            </a>
            <div class="collapse" id="menuUsers">
                {% comment %} <ul class="nav flex-column ms-3">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'index' %}">Ver</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="{% url 'index' %}?action=new">Nuevo</a>
                    </li>
                </ul> {% endcomment %}
            </div>
        </li>
        {% endif %}

        <!-- LOGOUT -->
        <li class="nav-item">
            <a class="nav-link text-white" href="{% url 'logout' %}">LOGOUT</a>
        </li>

        <!-- Debug info (opcional) -->
        {% if debug %}
        <li class="nav-item mt-4">
            <div class="small text-info">
                <strong>Grupos:</strong> {{ user|get_groups|join:", " }}
            </div>
        </li>
        {% endif %}
    </ul>
</nav>