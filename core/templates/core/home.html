{% load static %}
<link rel="stylesheet" href="{% static 'core/css/home.css' %}">
<!DOCTYPE html>
<html lang="es">
<head>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Panificadora Dorada - Productos artesanales de panader√≠a y pasteler√≠a desde 1985">
    <meta name="keywords" content="panader√≠a, pasteler√≠a, pan artesanal, tortas, boller√≠a">
    <title>Panificadora Dorada - Panader√≠a Artesanal</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçû</text></svg>">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS Personalizado -->
    <link rel="stylesheet" href="{% static 'core/css/home.css' %}?v=1.1">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="javascript:void(0)">
                <i class="fas fa-bread-slice me-2"></i>
                Panificadora PanLYR
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#inicio">Inicio</a>
                    </li>
                    <li class="nav-item">
                       <a class="nav-link" href="{% url 'product_catalog' %}">Cat√°logo</a> 
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'pedidos' %}">pedidos</a> 
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contacto">Contacto</a>
                    </li>
                    <li class="nav-item ms-2">
                        <a href="/auth_users/login/" class="btn btn-gold">Login</a>
                    </li>
                    <li class="nav-item ms-2">
                        <a href="/auth_users/register/" class="btn btn-gold">Registrarse</a>
                    </li>
                    <li class="nav-item ms-2">
                        <button class="btn btn-gold" id="cart-button">
                            <i class="fas fa-shopping-cart"></i>
                            <span class="badge rounded-pill cart-badge" id="cart-count">0</span>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section text-center" id="inicio">
        <div class="container">
            <h1 class="display-4 fw-bold mb-4">Delicias artesanales horneadas con amor</h1>
            <p class="lead mb-5">Descubre nuestros panes y pasteles elaborados con recetas tradicionales e ingredientes frescos</p>
            <a href="{% url 'product_catalog' %}" class="btn btn-gold btn-lg px-4 py-2 me-2">Ver Cat√°logo</a> 
            <a href="{% url 'pedidos' %}" class="btn btn-outline-light btn-lg px-4 py-2">Realizar Pedido</a>
        </div>
    </section>

    <!-- Featured Products -->
    <section class="py-5">
        <div class="container">
            <h2 class="text-center mb-4">Nuestras especialidades</h2>
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <img src="https://cdn.pixabay.com/photo/2016/03/27/21/59/bread-1284438_1280.jpg" class="card-img-top" alt="Pan de masa madre">
                        <div class="card-body text-center">
                            <h5 class="card-title">Pan de masa madre</h5>
                            <p class="card-text">Nuestro pan estrella, con una corteza crujiente y miga alveolada.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <img src="https://images.unsplash.com/photo-1700915704616-b455b3679024?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3NjkwMjR8MHwxfHNlYXJjaHwzfHxDcm9pc3NhbnRzfGVufDB8fHx8MTc1OTAyNTY1M3ww&ixlib=rb-4.1.0&q=80&w=1080" class="card-img-top" alt="Croissants">
                        <div class="card-body text-center">
                            <h5 class="card-title">Croissants artesanales</h5>
                            <p class="card-text">Horneados diariamente, con una textura hojaldrada perfecta.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <div class="card h-100 border-0 shadow-sm">
                        <img src="https://cdn.pixabay.com/photo/2016/11/29/11/38/cake-1869227_1280.jpg" class="card-img-top" alt="Torta de chocolate">
                        <div class="card-body text-center">
                            <h5 class="card-title">Torta de chocolate</h5>
                            <p class="card-text">Esponjosa y con el balance perfecto de dulzura.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Contacto -->
    <section class="py-5" id="contacto">
        <div class="container">
            <h2 class="section-title text-center">Contacto</h2>
            <div class="row">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h5 class="mb-3">Informaci√≥n de Contacto</h5>
                    <ul class="list-unstyled">
                        <li class="mb-3">
                            <i class="fas fa-map-marker-alt text-gold me-2"></i> Av. Principal 123, Ciudad
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-phone text-gold me-2"></i> (123) 456-7890
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-envelope text-gold me-2"></i> info@panificadoradorada.com
                        </li>
                        <li class="mb-3">
                            <i class="fas fa-clock text-gold me-2"></i> Lun-S√°b: 7:00 AM - 8:00 PM | Dom: 8:00 AM - 2:00 PM
                        </li>
                    </ul>
                    <div class="mt-4">
                        <h5 class="mb-3">S√≠guenos en Redes Sociales</h5>
                        <a href="javascript:void(0)" class="text-decoration-none me-3">
                            <i class="fab fa-facebook fa-2x text-brown"></i>
                        </a>
                        <a href="javascript:void(0)" class="text-decoration-none me-3">
                            <i class="fab fa-instagram fa-2x text-brown"></i>
                        </a>
                        <a href="javascript:void(0)" class="text-decoration-none">
                            <i class="fab fa-twitter fa-2x text-brown"></i>
                        </a>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card border-0 shadow">
                        <div class="card-body p-4">
                            <h5 class="mb-3">Env√≠anos un Mensaje</h5>
                            <form id="contact-form">
                                <div class="mb-3">
                                    <label for="contact-name" class="form-label">Nombre</label>
                                    <input type="text" class="form-control" id="contact-name" required>
                                </div>
                                <div class="mb-3">
                                    <label for="contact-email" class="form-label">Correo electr√≥nico</label>
                                    <input type="email" class="form-control" id="contact-email" required>
                                </div>
                                <div class="mb-3">
                                    <label for="contact-subject" class="form-label">Asunto</label>
                                    <input type="text" class="form-control" id="contact-subject">
                                </div>
                                <div class="mb-3">
                                    <label for="contact-message" class="form-label">Mensaje</label>
                                    <textarea class="form-control" id="contact-message" rows="4" required></textarea>
                                </div>
                                <button type="submit" class="btn btn-gold">Enviar Mensaje</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-4">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4 mb-lg-0">
                    <h5 class="text-gold">Panificadora Dorada</h5>
                    <p>Elaboramos productos de panader√≠a y pasteler√≠a artesanal desde 1985, manteniendo la tradici√≥n y calidad en cada uno de nuestros productos.</p>
                </div>
                <div class="col-lg-4 mb-4 mb-lg-0">
                    <h5 class="text-gold">Enlaces R√°pidos</h5>
                    <ul class="list-unstyled">
                        <li><a href="#inicio">Inicio</a></li>
                        <li><a href="{% url 'product_catalog' %}">Cat√°logo</a></li>
                        <li><a href="#pedidos">Pedidos</a></li>
                        <li><a href="#contacto">Contacto</a></li>
                    </ul>
                </div>
                <div class="col-lg-4">
                    <h5 class="text-gold">Suscr√≠bete a nuestro bolet√≠n</h5>
                    <p>Recibe nuestras novedades y promociones directamente en tu correo.</p>
                    <form id="subscribe-form">
                        <div class="input-group mb-3">
                            <input type="email" class="form-control" placeholder="Tu correo electr√≥nico" required>
                            <button class="btn btn-gold" type="submit">Suscribirse</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="border-top border-secondary mt-4 pt-4 text-center">
                <p class="mb-0">&copy; 2025 Panificadora Dorada. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>
    
    <!-- Carrito Sidebar -->
    <div id="cart-sidebar">
        <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
            <h5 class="mb-0">Tu Pedido</h5>
            <button class="btn-close" id="close-cart"></button>
        </div>
        <div id="cart-sidebar-items" class="p-3">
            <p class="text-muted text-center">No hay productos en tu carrito</p>
        </div>
        <div class="p-3 border-top">
            <div class="d-flex justify-content-between mb-3">
                <span class="fw-bold">Total:</span>
                <span class="fw-bold" id="cart-sidebar-total">$0.00</span>
            </div>
            <a href="{% url 'pedidos' %}" class="btn btn-gold w-100" >Realizar Pedido</a>
        </div>
    </div>
    
    <div class="overlay" id="cart-overlay"></div>
    
    <!-- Formulario de Rese√±a (Modal) -->
    <div class="modal fade" id="review-modal" tabindex="-1" aria-labelledby="reviewModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reviewModalLabel">Escribir una Rese√±a</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="review-form">
                        <div class="mb-3">
                            <label for="review-name" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="review-name" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Calificaci√≥n</label>
                            <div class="star-rating-input mb-2">
                                <i class="far fa-star star-rating-clickable" data-rating="1"></i>
                                <i class="far fa-star star-rating-clickable" data-rating="2"></i>
                                <i class="far fa-star star-rating-clickable" data-rating="3"></i>
                                <i class="far fa-star star-rating-clickable" data-rating="4"></i>
                                <i class="far fa-star star-rating-clickable" data-rating="5"></i>
                            </div>
                            <input type="hidden" id="review-rating" value="0" required>
                        </div>
                        <div class="mb-3">
                            <label for="review-comment" class="form-label">Comentario</label>
                            <textarea class="form-control" id="review-comment" rows="4" required></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-gold" id="submit-review">Enviar Rese√±a</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmaci√≥n de Pedido (Modal) -->
    <div class="modal fade" id="order-confirmation-modal" tabindex="-1" aria-labelledby="orderConfirmationLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="orderConfirmationLabel">¬°Pedido recibido!</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center py-4">
                    <i class="fas fa-check-circle text-success fa-4x mb-3"></i>
                    <h4>¬°Gracias por tu pedido!</h4>
                    <p>Hemos recibido tu solicitud correctamente. Te contactaremos pronto para confirmar los detalles.</p>
                    <p class="mb-0"><strong>N√∫mero de pedido:</strong> <span id="order-number"></span></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script id="app-script">
document.addEventListener('DOMContentLoaded', function() {
    // Carrito de compras
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    updateCartDisplay();
    
    // === Botones "A√±adir al carrito" (solo si existen) ===
    document.querySelectorAll('.add-to-cart').forEach(button => {
        button.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            const name = this.getAttribute('data-name');
            const price = parseFloat(this.getAttribute('data-price'));
            
            const existingItem = cart.find(item => item.id === id);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id, name, price, quantity: 1 });
            }
            
            saveCart();
            updateCartDisplay();
            showCartSidebar();
            
            // Notificaci√≥n
            const toast = document.createElement('div');
            toast.className = 'position-fixed bottom-0 end-0 p-3';
            toast.style.zIndex = '1100';
            toast.innerHTML = `
                <div class="toast show align-items-center text-bg-dark border-0" role="alert">
                    <div class="d-flex">
                        <div class="toast-body">‚úÖ ${name} a√±adido al carrito</div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                    </div>
                </div>`;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        });
    });

    // === Carrito sidebar ===
    const cartButton = document.getElementById('cart-button');
    const closeCart = document.getElementById('close-cart');
    const cartOverlay = document.getElementById('cart-overlay');
    
    if (cartButton) cartButton.addEventListener('click', showCartSidebar);
    if (closeCart) closeCart.addEventListener('click', hideCartSidebar);
    if (cartOverlay) cartOverlay.addEventListener('click', hideCartSidebar);

    // === Formulario de contacto ===
    const contactForm = document.getElementById('contact-form');
    if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
            e.preventDefault();
            alert('¬°Gracias por tu mensaje!');
            this.reset();
        });
    }

    // === Formulario de suscripci√≥n ===
    const subscribeForm = document.getElementById('subscribe-form');
    if (subscribeForm) {
        subscribeForm.addEventListener('submit', function(e) {
            e.preventDefault();
            alert('¬°Gracias por suscribirte!');
            this.reset();
        });
    }

    // === Calificaci√≥n por estrellas ===
    document.querySelectorAll('.star-rating-clickable').forEach(star => {
        star.addEventListener('click', function() {
            const rating = parseInt(this.getAttribute('data-rating'));
            const input = document.getElementById('review-rating');
            if (input) input.value = rating;
            
            document.querySelectorAll('.star-rating-clickable').forEach((s, i) => {
                s.className = i < rating 
                    ? 'fas fa-star star-rating-clickable' 
                    : 'far fa-star star-rating-clickable';
            });
        });
        
        star.addEventListener('mouseover', function() {
            const rating = parseInt(this.getAttribute('data-rating'));
            document.querySelectorAll('.star-rating-clickable').forEach((s, i) => {
                if (i < rating) s.classList.replace('far', 'fas');
            });
        });
        
        star.addEventListener('mouseout', function() {
            const selected = parseInt(document.getElementById('review-rating')?.value || '0');
            document.querySelectorAll('.star-rating-clickable').forEach((s, i) => {
                s.className = i < selected 
                    ? 'fas fa-star star-rating-clickable' 
                    : 'far fa-star star-rating-clickable';
            });
        });
    });

    // === Enviar rese√±a ===
    const submitReview = document.getElementById('submit-review');
    if (submitReview) {
        submitReview.addEventListener('click', function() {
            const name = document.getElementById('review-name')?.value;
            const rating = document.getElementById('review-rating')?.value;
            const comment = document.getElementById('review-comment')?.value;
            
            if (!name || rating === '0' || !comment) {
                alert('Completa todos los campos');
                return;
            }
            alert('¬°Gracias por tu rese√±a!');
            const modal = bootstrap.Modal.getInstance(document.getElementById('review-modal'));
            modal?.hide();
            document.getElementById('review-form')?.reset();
            document.querySelectorAll('.star-rating-clickable').forEach(s => {
                s.className = 'far fa-star star-rating-clickable';
            });
            if (document.getElementById('review-rating')) document.getElementById('review-rating').value = '0';
        });
    }

    // === Scroll suave ===
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                window.scrollTo({ top: target.offsetTop - 70, behavior: 'smooth' });
                const navbar = document.getElementById('navbarNav');
                if (navbar?.classList.contains('show')) {
                    bootstrap.Collapse.getInstance(navbar)?.hide();
                }
            }
        });
    });

    // === Funciones auxiliares ===
    function saveCart() {
        localStorage.setItem('cart', JSON.stringify(cart));
    }
    
    function updateCartDisplay() {
        const cartCount = document.getElementById('cart-count');
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        if (cartCount) cartCount.textContent = totalItems;

        const cartSidebarItems = document.getElementById('cart-sidebar-items');
        const cartTotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        
        if (cartSidebarItems) {
            if (cart.length === 0) {
                cartSidebarItems.innerHTML = '<p class="text-muted text-center">No hay productos en tu carrito</p>';
            } else {
                let html = '';
                cart.forEach(item => {
                    html += `
                        <div class="cart-item border-bottom pb-3 mb-3">
                            <div class="d-flex justify-content-between">
                                <h6 class="mb-1">${item.name}</h6>
                                <span>$${(item.price * item.quantity).toFixed(2)}</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="d-flex align-items-center">
                                    <button class="btn btn-sm btn-outline-secondary decrease-quantity" data-id="${item.id}">-</button>
                                    <span class="mx-2">${item.quantity}</span>
                                    <button class="btn btn-sm btn-outline-secondary increase-quantity" data-id="${item.id}">+</button>
                                </div>
                                <button class="btn btn-sm text-danger remove-item" data-id="${item.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                });
                cartSidebarItems.innerHTML = html;

                // Eventos para cantidad
                document.querySelectorAll('.decrease-quantity').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.getAttribute('data-id');
                        const item = cart.find(i => i.id === id);
                        if (item) {
                            if (item.quantity > 1) item.quantity--;
                            else cart = cart.filter(i => i.id !== id);
                            saveCart(); updateCartDisplay();
                        }
                    });
                });
                document.querySelectorAll('.increase-quantity').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.getAttribute('data-id');
                        const item = cart.find(i => i.id === id);
                        if (item) { item.quantity++; saveCart(); updateCartDisplay(); }
                    });
                });
                document.querySelectorAll('.remove-item').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.getAttribute('data-id');
                        cart = cart.filter(i => i.id !== id);
                        saveCart(); updateCartDisplay();
                    });
                });
            }
        }

        const cartSidebarTotal = document.getElementById('cart-sidebar-total');
        if (cartSidebarTotal) cartSidebarTotal.textContent = `$${cartTotal.toFixed(2)}`;
    }
    
    function showCartSidebar() {
        document.getElementById('cart-sidebar')?.classList.add('show');
        document.getElementById('cart-overlay')?.classList.add('show');
    }
    
    function hideCartSidebar() {
        document.getElementById('cart-sidebar')?.classList.remove('show');
        document.getElementById('cart-overlay')?.classList.remove('show');
    }
});
</script>